---
title: "Class: Redactor"
description: "Defined in: [src/shield/redaction/redactor.ts:150](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor"
icon: "cube"
---

[Dotset CLI API Documentation](/api) / [index](/api/shield) / Redactor

# Class: Redactor

Defined in: [src/shield/redaction/redactor.ts:150](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L150)

Redactor class for detecting and handling secrets in output streams.

## Constructors

### Constructor

```ts
new Redactor(options): Redactor;
```

Defined in: [src/shield/redaction/redactor.ts:203](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L203)

#### Parameters

##### options

[`RedactorOptions`](../interfaces/RedactorOptions.md) = `{}`

#### Returns

`Redactor`

## Methods

### addAllowlist()

```ts
addAllowlist(entries): void;
```

Defined in: [src/shield/redaction/redactor.ts:397](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L397)

Add allowlist entries (supports glob, regex, and literal patterns)

#### Parameters

##### entries

[`AllowlistEntry`](../interfaces/AllowlistEntry.md)[]

#### Returns

`void`

### addBlockedStrings()

```ts
addBlockedStrings(strings): void;
```

Defined in: [src/shield/redaction/redactor.ts:386](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L386)

#### Parameters

##### strings

`string`[]

#### Returns

`void`

### addExcludeKeywords()

```ts
addExcludeKeywords(keywords): void;
```

Defined in: [src/shield/redaction/redactor.ts:426](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L426)

Add keywords to exclude from contextual detection

#### Parameters

##### keywords

`string`[]

#### Returns

`void`

### addPattern()

```ts
addPattern(
   name, 
   pattern, 
   flags, 
   severity): boolean;
```

Defined in: [src/shield/redaction/redactor.ts:336](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L336)

#### Parameters

##### name

`string`

##### pattern

`string`

##### flags

`string` = `'gi'`

##### severity

`"low"` | `"medium"` | `"high"` | `"critical"`

#### Returns

`boolean`

### addSensitiveKeywords()

```ts
addSensitiveKeywords(keywords): void;
```

Defined in: [src/shield/redaction/redactor.ts:417](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L417)

Add custom sensitive keywords

#### Parameters

##### keywords

`string`[]

#### Returns

`void`

### clearPatterns()

```ts
clearPatterns(): void;
```

Defined in: [src/shield/redaction/redactor.ts:303](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L303)

#### Returns

`void`

### flush()

```ts
flush(): Buffer<ArrayBufferLike> | null;
```

Defined in: [src/shield/redaction/redactor.ts:949](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L949)

#### Returns

`Buffer`\<`ArrayBufferLike`\> \| `null`

### getExcludeKeywords()

```ts
getExcludeKeywords(): string[];
```

Defined in: [src/shield/redaction/redactor.ts:1084](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L1084)

Get exclude keywords

#### Returns

`string`[]

### getExposureCount()

```ts
getExposureCount(): number;
```

Defined in: [src/shield/redaction/redactor.ts:1034](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L1034)

#### Returns

`number`

### getMinConfidence()

```ts
getMinConfidence(): number;
```

Defined in: [src/shield/redaction/redactor.ts:1063](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L1063)

Get the minimum confidence threshold

#### Returns

`number`

### getMode()

```ts
getMode(): ProtectionMode;
```

Defined in: [src/shield/redaction/redactor.ts:307](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L307)

#### Returns

### getPatternCount()

```ts
getPatternCount(): number;
```

Defined in: [src/shield/redaction/redactor.ts:1038](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L1038)

#### Returns

`number`

### getPatternErrors()

```ts
getPatternErrors(): readonly PatternCompilationError[];
```

Defined in: [src/shield/redaction/redactor.ts:378](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L378)

#### Returns

readonly [`PatternCompilationError`](PatternCompilationError.md)[]

### getSensitiveKeywords()

```ts
getSensitiveKeywords(): string[];
```

Defined in: [src/shield/redaction/redactor.ts:1077](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L1077)

Get sensitive keywords

#### Returns

`string`[]

### getTrackedSecretCount()

```ts
getTrackedSecretCount(): number;
```

Defined in: [src/shield/redaction/redactor.ts:1042](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L1042)

#### Returns

`number`

### hasPatternErrors()

```ts
hasPatternErrors(): boolean;
```

Defined in: [src/shield/redaction/redactor.ts:382](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L382)

#### Returns

`boolean`

### isContextualEnabled()

```ts
isContextualEnabled(): boolean;
```

Defined in: [src/shield/redaction/redactor.ts:1056](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L1056)

Check if contextual detection is enabled

#### Returns

`boolean`

### isEntropyEnabled()

```ts
isEntropyEnabled(): boolean;
```

Defined in: [src/shield/redaction/redactor.ts:1049](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L1049)

Check if entropy detection is enabled

#### Returns

`boolean`

### scan()

```ts
scan(text): SecretMatch[];
```

Defined in: [src/shield/redaction/redactor.ts:548](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L548)

Performs a comprehensive scan of the provided text

#### Parameters

##### text

`string`

#### Returns

[`SecretMatch`](../interfaces/SecretMatch.md)[]

### setMinConfidence()

```ts
setMinConfidence(threshold): void;
```

Defined in: [src/shield/redaction/redactor.ts:1070](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L1070)

Set minimum confidence threshold

#### Parameters

##### threshold

`number`

#### Returns

`void`

### setMode()

```ts
setMode(mode): void;
```

Defined in: [src/shield/redaction/redactor.ts:311](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L311)

#### Parameters

##### mode

#### Returns

`void`

### trackSecret()

```ts
trackSecret(name, value): void;
```

Defined in: [src/shield/redaction/redactor.ts:315](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L315)

#### Parameters

##### name

`string`

##### value

`string`

#### Returns

`void`

### trackSecrets()

```ts
trackSecrets(secrets): void;
```

Defined in: [src/shield/redaction/redactor.ts:330](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L330)

#### Parameters

##### secrets

`Record`\<`string`, `string`\>

#### Returns

`void`

### transform()

```ts
transform(data): Buffer<ArrayBufferLike> | null;
```

Defined in: [src/shield/redaction/redactor.ts:930](https://github.com/dotsetlabs/cli/blob/5d9ea0fe5050d4d18b89d35a8fee54f876108d8f/src/shield/redaction/redactor.ts#L930)

#### Parameters

##### data

`string` | `Buffer`\<`ArrayBufferLike`\>

#### Returns

`Buffer`\<`ArrayBufferLike`\> \| `null`
