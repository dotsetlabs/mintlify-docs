---
title: Audit Logging
description: 'Complete audit trail for compliance and debugging'
---

# Audit Logging

Tollgate maintains a complete audit log of all tool calls, policy decisions, and user approvals. This enables compliance reporting, debugging, and security analysis.

## What's Logged

Every tool call records:

| Field | Description |
|:------|:------------|
| `timestamp` | When the call occurred |
| `server` | MCP server name |
| `tool` | Tool being called |
| `arguments` | Tool arguments (optionally redacted) |
| `policyDecision` | What the policy said (`allow`, `deny`, `prompt`) |
| `userDecision` | What the user chose (for prompts) |
| `result` | Whether the call succeeded |
| `durationMs` | How long the call took |
| `riskLevel` | Analyzer-determined risk |

## Viewing Logs

### Recent Activity

```bash
# Last 20 entries
tollgate logs

# Last 100 entries
tollgate logs -n 100
```

### Statistics

```bash
tollgate stats
```

## Exporting Logs

Export for compliance reporting or SIEM integration:

```bash
# JSON format
tollgate export -f json -o audit.json

# CSV for spreadsheets
tollgate export -f csv -o audit.csv

# CEF for SIEM (Splunk, Datadog, etc.)
tollgate export -f cef -o audit.cef

# JSONL for streaming
tollgate export -f jsonl
```

### Filtering Exports

```bash
# Last 24 hours
tollgate export --since "2024-01-14T00:00:00Z"

# Specific server
tollgate export -s postgres

# Only dangerous operations
tollgate export --risk dangerous

# Date range
tollgate export \
  --since "2024-01-01" \
  --until "2024-01-31" \
  -o january-report.json
```

## PII Redaction

By default, tool arguments are redacted in logs to protect sensitive data:

```json
{
  "tool": "query",
  "arguments": "[REDACTED]",
  "argumentsHash": "sha256:abc123..."
}
```

The hash allows correlation without exposing data.

### Disabling Redaction

For debugging, you can export with original data:

```bash
tollgate export --no-redact -o debug.json
```

> [!CAUTION]
> Non-redacted exports may contain PII, credentials, or sensitive data. Handle with appropriate security controls.

## Storage Location

Audit logs are stored in SQLite at:

```
~/.dotset/tollgate.db
```

Override with `--audit-path`:

```bash
tollgate start -s postgres --audit-path /var/log/tollgate.db
```

## Retention

Tollgate does not automatically delete old logs. For compliance, implement your own retention policy:

```bash
# Export and archive old logs
tollgate export \
  --until "$(date -v-90d +%Y-%m-%d)" \
  -o archive-$(date +%Y%m%d).json

# Clear database (caution: irreversible)
rm ~/.dotset/tollgate.db
```

## SIEM Integration

### Splunk

```bash
# Real-time forwarding
tollgate export -f cef | nc splunk-server 514
```

### Datadog

```bash
# Export JSONL for Datadog logs
tollgate export -f jsonl | \
  datadog-agent-pipe --source tollgate
```

### CloudWatch

```bash
# Export and upload
tollgate export -f jsonl -o /tmp/audit.jsonl
aws logs create-log-stream --log-group-name tollgate ...
aws logs put-log-events --log-group-name tollgate ...
```

## Compliance

Tollgate audit logs support:

- **SOC 2**: Complete access logging with user attribution
- **GDPR**: PII redaction by default
- **CCPA**: Data access visibility
- **HIPAA**: Audit trail for PHI access (when properly configured)
