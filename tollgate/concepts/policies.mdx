---
title: Policies
description: 'Understanding Tollgate policy actions and configuration'
---

# Policy Actions

Tollgate uses a policy-based access control model. Each tool call is evaluated against policies to determine the appropriate action.

## Actions

| Action | Behavior | Use Case |
|:-------|:---------|:---------|
| `allow` | Proceed without approval | Trusted, read-only operations |
| `deny` | Block entirely | Dangerous or disallowed operations |
| `prompt` | Ask user for approval | Operations requiring human review |

### allow

The tool call proceeds immediately without user interaction.

```yaml
tools:
  "query":
    action: allow
```

**Best for:**
- Read-only operations
- Well-understood, safe tools
- High-frequency operations where prompts would be disruptive

### deny

The tool call is blocked and an error is returned to the AI agent.

```yaml
tools:
  "delete_*":
    action: deny
    reason: "Deletion is not permitted"
```

**Best for:**
- Destructive operations like DELETE, DROP, TRUNCATE
- Administrative commands
- Operations outside the agent's scope

### prompt

The user is asked to approve or reject the tool call in the terminal.

```yaml
tools:
  "execute":
    action: prompt
    message: "Agent wants to execute SQL"
```

**Best for:**
- Write operations
- Sensitive data access
- Any operation where human judgment is valuable

## Policy Matching

Policies are matched using glob patterns:

```yaml
tools:
  # Exact match
  "query":
    action: allow

  # Prefix match
  "read_*":
    action: allow

  # Suffix match
  "*_dangerous":
    action: deny

  # Catch-all (should always be last)
  "*":
    action: prompt
```

### Match Priority

Policies are evaluated in order. The first matching policy wins:

```yaml
tools:
  "read_file":     # Matches first for 'read_file'
    action: allow
  "read_*":        # Matches for other 'read_' tools
    action: prompt
  "*":             # Catches everything else
    action: deny
```

## Smart Policies with Analyzers

For content-aware decisions, use analyzers:

```yaml
tools:
  "execute":
    analyzer: sql
    risks:
      read: allow
      write: prompt
      destructive: deny
      dangerous: deny
```

The analyzer inspects the tool's arguments and classifies the risk level.

[Learn more about analyzers →](/tollgate/concepts/analyzers)

## Session-Based Approvals

Reduce approval fatigue with session grants:

```yaml
tools:
  "write_file":
    action: prompt
    session:
      enabled: true
      duration: "15m"
      scope: "tool"
```

When a user approves, subsequent identical requests are auto-approved for the session duration.

[Learn more about sessions →](/tollgate/concepts/sessions)

## Example Configurations

### Strict (Maximum Security)

```yaml
defaults:
  action: deny

servers:
  postgres:
    tools:
      "query":
        action: prompt
      "*":
        action: deny
```

### Balanced (Recommended)

```yaml
defaults:
  action: prompt

servers:
  postgres:
    tools:
      "query":
        action: allow
      "execute":
        analyzer: sql
        risks:
          read: allow
          write: prompt
          destructive: deny
          dangerous: deny
      "*":
        action: deny
```

### Permissive (Development Only)

```yaml
defaults:
  action: allow

servers:
  postgres:
    tools:
      "*":
        action: allow
```

> [!CAUTION]
> Permissive policies should only be used in development environments with non-sensitive data.
