---
title: wrap
description: 'Wrap any MCP server with Tollgate protection'
---

# tollgate wrap

Wraps an MCP server command with Tollgate protection without requiring a configuration file. Perfect for quick setup and testing.

## Usage

```bash
tollgate wrap [options] <command> [args...]
```

## Options

| Option | Description | Default |
|--------|-------------|---------|
| `-d, --default <action>` | Default action: `allow`, `deny`, or `prompt` | `prompt` |
| `--audit-path <path>` | Custom path for audit database | `~/.tollgate/audit.db` |
| `--timeout <ms>` | Approval timeout in milliseconds | `60000` |
| `--approval <method>` | Approval method: `terminal` or `interactive` | `terminal` |
| `--approval-port <port>` | Port for interactive approval UI | `9847` |
| `--persist-sessions` | Persist session grants to disk | - |
| `--session-path <path>` | Path for persistent session database | `~/.tollgate/sessions.db` |
| `--dry-run` | Evaluate policies without executing tools | - |
| `--failure-mode <mode>` | Behavior when upstream fails | `fail-closed` |

## Examples

### Basic Usage

```bash
# Wrap a PostgreSQL MCP server (prompts for all tool calls)
tollgate wrap npx @modelcontextprotocol/server-postgres

# Wrap a filesystem server
tollgate wrap npx @anthropic/mcp-server-filesystem ./src
```

### Default Actions

```bash
# Allow all by default (use for trusted servers)
tollgate wrap -d allow npx mcp-server-trusted

# Deny all by default (maximum security)
tollgate wrap -d deny npx mcp-server-untrusted

# Prompt for everything (recommended)
tollgate wrap -d prompt npx mcp-server-postgres
```

### Testing with Dry Run

```bash
# See what would happen without actually executing tools
tollgate wrap --dry-run npx mcp-server-postgres
```

### Failure Modes

```bash
# Deny all operations if upstream server fails (safest)
tollgate wrap --failure-mode fail-closed npx mcp-server

# Allow only reads if upstream fails
tollgate wrap --failure-mode fail-readonly npx mcp-server

# Allow all operations if upstream fails (development only)
tollgate wrap --failure-mode fail-open npx mcp-server
```

### Interactive Approval UI

```bash
# Approve requests via web browser instead of terminal
tollgate wrap --approval interactive npx mcp-server-postgres

# Open http://localhost:9847 to see pending approvals
```

### Persistent Sessions

```bash
# Session grants survive process restarts
tollgate wrap --persist-sessions npx mcp-server-postgres
```

## How It Works

When you wrap an MCP server:

1. Tollgate spawns the upstream MCP server as a child process
2. All MCP traffic flows through Tollgate
3. Tool calls are intercepted and evaluated against the default policy
4. User is prompted for approval when action is `prompt`
5. All decisions are logged to the audit database

## When to Use

**Use wrap mode when:**
- Testing a new MCP server
- Quick protection without config files
- Running one-off commands
- Development and debugging

**Use config mode (`start`) when:**
- You need per-tool policies
- Running in production
- Multiple servers with different policies
- Smart content analysis is required
