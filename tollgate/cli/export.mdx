---
title: export
description: 'Export audit logs for compliance reporting'
---

# tollgate export

Exports audit logs in various formats for compliance reporting, SIEM integration, and analysis.

## Usage

```bash
tollgate export [options]
```

## Options

| Option | Description | Default |
|--------|-------------|---------|
| `-f, --format <format>` | Export format: `json`, `jsonl`, `csv`, or `cef` | `jsonl` |
| `-o, --output <path>` | Output file path (omit for stdout) | stdout |
| `--since <date>` | Only include records since this date (ISO format) | - |
| `--until <date>` | Only include records until this date (ISO format) | - |
| `-s, --server <name>` | Filter by server name | - |
| `-n, --limit <count>` | Maximum number of records to export | - |
| `--risk <level>` | Filter by risk level | - |
| `--no-redact` | Include original (non-redacted) data | - |
| `--audit-path <path>` | Custom path for audit database | `~/.dotset/tollgate.db` |

## Formats

### JSON

Complete JSON array of all records:

```bash
tollgate export -f json -o audit.json
```

### JSON Lines (Default)

One JSON object per line, ideal for streaming:

```bash
tollgate export -f jsonl -o audit.jsonl
```

### CSV

Comma-separated values for spreadsheet analysis:

```bash
tollgate export -f csv -o audit.csv
```

### CEF (Common Event Format)

For SIEM integration (Splunk, Datadog, etc.):

```bash
tollgate export -f cef -o audit.cef
```

## Examples

### Basic Export

```bash
# Export all logs as JSONL to stdout
tollgate export

# Export as JSON to file
tollgate export -f json -o audit.json
```

### Filtering

```bash
# Export logs from last 24 hours
tollgate export --since "2024-01-14T00:00:00Z"

# Export only postgres server logs
tollgate export -s postgres

# Export only dangerous operations
tollgate export --risk dangerous

# Combine filters
tollgate export -s postgres --risk write --since "2024-01-01"
```

### Compliance Reporting

```bash
# Weekly compliance report
tollgate export \
  --since "2024-01-08T00:00:00Z" \
  --until "2024-01-15T00:00:00Z" \
  -f csv \
  -o weekly-report.csv
```

### SIEM Integration

```bash
# Export to Splunk
tollgate export -f cef | nc splunk-server 514

# Continuous export for real-time monitoring
while true; do
  tollgate export -f cef --since "$(date -u -v-1M +%Y-%m-%dT%H:%M:%SZ)" | \
    nc siem-server 514
  sleep 60
done
```

## Risk Levels

| Level | Description |
|-------|-------------|
| `safe` | No-op or informational |
| `read` | Read-only operations |
| `write` | Data modification |
| `destructive` | Potentially irreversible changes |
| `dangerous` | High-risk operations |

## Privacy Considerations

By default, tool arguments are redacted in exports. Use `--no-redact` to include original data:

```bash
# Includes PII/sensitive data - use with caution
tollgate export --no-redact -o full-audit.json
```

> [!CAUTION]
> Using `--no-redact` may expose sensitive data. Ensure proper access controls on output files.
