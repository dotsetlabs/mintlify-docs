---
title: Signing Packages
description: How to sign your MCP server packages for distribution
---

# Signing Packages

This guide shows you how to sign your MCP server packages with Countersign so users can verify their authenticity.

## Why Sign?

Signing your packages:

- **Builds trust**: Users can verify your identity
- **Prevents tampering**: Any modification invalidates the signature
- **Creates transparency**: Signatures are logged publicly
- **Reduces friction**: Users can auto-approve trusted publishers

## Prerequisites

1. **OIDC Identity**: GitHub, Google, or Microsoft account
2. **Countersign**: `npm install -g @dotsetlabs/countersign`
3. **Package ready**: Built and tested

## Quick Start

```bash
# Navigate to your package
cd my-mcp-server

# Sign the package
countersign sign --provider github

# Browser opens for GitHub OAuth
# Sign-in and authorize

# Package is now signed!
```

## Step-by-Step Guide

### 1. Prepare Your Package

Ensure your package is ready:

```bash
# Build
npm run build

# Test
npm test

# Check package contents
npm pack --dry-run
```

### 2. Sign with Your Identity

Choose your identity provider:

```bash
# GitHub (recommended for open source)
countersign sign --provider github

# Google
countersign sign --provider google

# Microsoft
countersign sign --provider microsoft
```

### 3. Verify the Signature

```bash
countersign verify .
```

```
✓ my-mcp-server@1.0.0
  Trust Score: 85/100 (HIGH)
  Publisher: your-username (via github.com)
  Signature: Valid (SIGSTORE)
```

### 4. Publish

```bash
npm publish
```

## What Gets Created

After signing:

```
my-mcp-server/
├── package.json
├── dist/
├── README.md
└── .sigstore/
    ├── bundle.json        # SIGSTORE attestation bundle
    ├── signature.sig      # Detached signature
    └── certificate.pem    # Short-lived certificate
```

The `.sigstore/` directory is automatically included when you `npm publish`.

## CI/CD Integration

### GitHub Actions (Recommended)

```yaml
# .github/workflows/release.yml
name: Release

on:
  release:
    types: [created]

jobs:
  publish:
    runs-on: ubuntu-latest
    permissions:
      id-token: write  # Required for SIGSTORE
      contents: read

    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-node@v4
        with:
          node-version: '20'
          registry-url: 'https://registry.npmjs.org'

      - run: npm ci
      - run: npm run build
      - run: npm test

      # Sign the package
      - name: Sign package
        run: npx @dotsetlabs/countersign sign --provider github

      # Publish with provenance
      - name: Publish
        run: npm publish --provenance --access public
        env:
          NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
```

### GitLab CI

```yaml
# .gitlab-ci.yml
publish:
  image: node:20
  id_tokens:
    SIGSTORE_ID_TOKEN:
      aud: sigstore
  script:
    - npm ci
    - npm run build
    - npx @dotsetlabs/countersign sign --provider gitlab
    - npm publish
```

## Best Practices

### Use GitHub Actions Identity

For open source projects, sign with GitHub Actions workload identity:

```yaml
permissions:
  id-token: write
```

This creates signatures tied to your repository, not personal accounts.

### Include Build Provenance

npm's built-in provenance pairs well with Countersign:

```bash
npm publish --provenance
```

This creates a complete audit trail from source to package.

### Verify Before Publishing

Always verify your own signature:

```bash
countersign sign --provider github
countersign verify .  # Should show HIGH trust
npm publish
```

### Automate in CI/CD

Don't rely on manual signing. Automate in your release pipeline to ensure every release is signed.

## Troubleshooting

### "Failed to get OIDC token"

Ensure your CI has the right permissions:

```yaml
permissions:
  id-token: write
```

### "Certificate expired"

SIGSTORE certificates are valid for 10 minutes. Sign and publish in one workflow run:

```bash
countersign sign && npm publish
```

### "Signature doesn't match"

The package was modified after signing. Rebuild and re-sign:

```bash
npm run build
countersign sign --provider github
```

## Verifying Your Published Package

After publishing, verify from npm:

```bash
countersign verify your-package-name
```

This confirms the signature survived the publish process.
