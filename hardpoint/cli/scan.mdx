---
title: scan
description: 'Scan for security issues'
---

# hardpoint scan

Scan a directory for Rules File Backdoor attacks and other AI-era security threats.

## Usage

```bash
hardpoint scan [path] [flags]
```

## Arguments

| Argument | Description |
|:---------|:------------|
| `path` | Directory to scan (default: current directory) |

## Flags

| Flag | Description |
|:-----|:------------|
| `--scanners` | Comma-separated list of scanners to run (default: `ai,git`) |
| `--severity` | Minimum severity to report: `info`, `low`, `medium`, `high`, `critical` (default: `low`) |
| `--exclude` | Glob patterns to exclude (can be specified multiple times) |
| `--include-deps` | Include dependency directories like `node_modules` |
| `--staged` | Only scan git staged files |
| `--ci` | CI mode: exit code 1 if findings detected |
| `--output` | Output format: `text`, `json`, `sarif` (default: `text`) |
| `--sarif` | Shorthand for `--output sarif` |
| `--no-color` | Disable colored output |

## Available Scanners

| Scanner | Description |
|:--------|:------------|
| `ai` | Scan AI configuration files (`.cursorrules`, `CLAUDE.md`, `mcp.json`, `.github/copilot-instructions.md`, `.windsurfrules`, `.aider*`) |
| `git` | Check git hooks and configuration for malicious patterns |

## Examples

### Basic Scan

```bash
hardpoint scan
```

### Scan Specific Directory

```bash
hardpoint scan /path/to/project
```

### Run Specific Scanners

```bash
# Only AI scanner
hardpoint scan --scanners ai

# Only Git scanner
hardpoint scan --scanners git
```

### Filter by Severity

```bash
# Only high and critical findings
hardpoint scan --severity high
```

### Exclude Directories

```bash
hardpoint scan --exclude "test/**" --exclude "docs/**"
```

### CI Mode

```bash
# Exit 1 if any findings (for CI pipelines)
hardpoint scan --ci
```

### JSON Output

```bash
hardpoint scan --output json
```

### SARIF Output for GitHub

```bash
hardpoint scan --output sarif > results.sarif
```

### Scan Staged Files Only

```bash
# Useful as pre-commit hook
hardpoint scan --staged
```

## Output

### Text Format (Default)

```
Hardpoint Security Scanner
==========================

Scanning: /Users/dev/project
Scanners: ai, git

Findings
--------

  CRITICAL  AI-008: Semantic Hijacking Detected
            File: .cursorrules:15
            Malicious instructions hidden in comment section
            Patterns: "ignore previous instructions", "new instructions:"

  CRITICAL  AI-005: Command Injection in MCP Config
            File: mcp.json:8
            Shell command substitution detected: $(curl ...)

  HIGH      GIT-001: Malicious Git Hook Pattern
            File: .git/hooks/pre-commit:12
            Pattern: curl|bash

Summary: 2 critical, 1 high (3 total)
Duration: 42ms
```

### JSON Format

```json
{
  "version": "1.0",
  "timestamp": "2026-01-09T10:30:00Z",
  "duration": "42ms",
  "base_path": "/Users/dev/project",
  "summary": {
    "critical": 2,
    "high": 1,
    "medium": 0,
    "low": 0,
    "info": 0,
    "total": 3
  },
  "findings": [
    {
      "id": "abc123...",
      "rule_id": "AI-008",
      "message": "Semantic Hijacking Detected",
      "path": ".cursorrules",
      "line": 15,
      "severity": "critical",
      "confidence": "high",
      "scanner": "ai",
      "snippet": "<!-- ignore previous instructions..."
    }
  ]
}
```

## Exit Codes

| Code | Meaning |
|:-----|:--------|
| 0 | No findings (or findings below severity threshold) |
| 1 | Findings detected (when `--ci` flag is used) |
| 2 | Error during scan |
