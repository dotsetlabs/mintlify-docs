---
title: Scanners
description: 'Understanding Hardpoint security scanners'
---

# Scanners

Hardpoint includes two specialized scanners, each targeting a specific attack surface in developer environments.

## AI Configuration Scanner

Detects threats in AI coding assistant configuration files, with a focus on the **Rules File Backdoor** attack.

### Files Scanned

| File | Target AI Assistant |
|:-----|:--------------------|
| `.cursorrules` | Cursor |
| `.cursor/rules/*.mdc` | Cursor (modular rules) |
| `CLAUDE.md`, `AGENTS.md` | Claude Code |
| `mcp.json`, `.mcp.json` | MCP clients |
| `.github/copilot-instructions.md` | GitHub Copilot |
| `.windsurfrules` | Windsurf |
| `COPILOT.md` | GitHub Copilot |
| `.aider*` | Aider |
| `rules.md` | Various AI assistants |

### Detection Rules

| ID | Name | Severity | Description |
|:---|:-----|:---------|:------------|
| **AI-004** | Encoded Instructions | Medium | Base64 or other encoded content hiding malicious payloads |
| **AI-005** | Command Injection in MCP Config | Critical | Shell metacharacters in mcp.json configurations |
| **AI-008** | Semantic Hijacking | Critical | Hidden malicious instructions (Rules File Backdoor) |

### AI-004: Encoded Instructions

Detects Base64 and other encoded content that may hide malicious instructions. Skips legitimate encoded content like images, hashes, and SHA signatures.

### AI-005: Command Injection in MCP Config

Detects shell metacharacters in MCP configuration files that could allow command injection:

- `$(command)` - Command substitution
- Backtick execution
- `&&`, `||`, `;` - Command chaining
- `${VAR}` - Variable expansion
- `<<EOF` - Heredocs
- Known dangerous commands with `-c` flag

### AI-008: Semantic Hijacking (Flagship)

Detects **Rules File Backdoor** attacks where malicious instructions are hidden in comments, metadata, or structural elements. This is Hardpoint's flagship detection with 80+ obfuscation-resistant patterns.

**Detection Methods:**
- Comment/content divergence scoring
- Hidden section detection (HTML comments, `_comment` fields)
- Pattern matching with multiple confidence levels
- Obfuscation resistance:
  - Unicode normalization (NFKC)
  - Leet speak handling (0→o, 1→i, 3→e, 4→a, 5→s, 7→t)
  - Homoglyph detection (Cyrillic/Greek lookalikes)

**Pattern Categories:**
- Instruction Override ("ignore previous instructions", "new instructions:")
- Role Manipulation ("you are now", "act as", "jailbreak")
- Data Exfiltration ("send data to", "steal api_keys", "exfiltrate")
- System Access ("execute command", "reverse shell", "spawn shell")
- Token Smuggling ("<|im_start|>", "[INST]", "<<SYS>>")

---

## Git Security Scanner

Checks git hooks and configuration for malicious patterns.

### Files Scanned

- `.git/hooks/*` (all hook scripts)
- `.git/config`
- `.gitconfig`

### Detection Rules

| ID | Name | Severity | Description |
|:---|:-----|:---------|:------------|
| **GIT-001** | Malicious Git Hook Pattern | Critical | `curl\|sh`, reverse shells, dangerous patterns |
| **GIT-002** | Credential Exfiltration in Hook | Critical | Hooks accessing secrets or credentials |
| **GIT-003** | Network Access in Git Hook | Medium | Unexpected network requests from hooks |
| **GIT-004** | Obfuscated Git Hook Content | High | `eval`, `base64 -d`, obfuscated code |
| **GIT-005** | Suspicious Git Remote URL | Medium | ngrok, localhost, .onion domains |
| **GIT-006** | Suspicious Credential Helper | High | Non-standard credential helpers |

### GIT-001: Malicious Git Hook Pattern

Detects dangerous patterns in git hooks:
- `curl|sh` or `wget|bash` (pipe to shell)
- `/dev/tcp/` (bash network access)
- `nc -e` (netcat reverse shell)
- `base64 -d | sh`

### GIT-002: Credential Exfiltration

Detects hooks that access credentials:
- `$AWS_SECRET_ACCESS_KEY`
- `$GITHUB_TOKEN`
- `$API_KEY`
- `cat ~/.ssh/`
- `cat ~/.aws/credentials`

### GIT-003: Network Access

Detects hooks that make network requests:
- `curl`, `wget`
- `nc`, `netcat`

### GIT-004: Obfuscated Content

Detects obfuscation in hooks:
- `eval`
- `base64 -d`
- `printf \\x`
- `xxd -r`

### GIT-005: Suspicious Remote URL

Detects suspicious git remote URLs:
- `ngrok.io`
- `localhost`, `127.0.0.1`, `0.0.0.0`
- `.onion` domains

### GIT-006: Suspicious Credential Helper

Detects suspicious credential helper configuration:
- Helper containing `curl` or `wget`
- Helper pointing to `/tmp/`
- Helper using `bash -c`

---

## Running Specific Scanners

```bash
# Run only AI scanner
hardpoint scan --scanners ai

# Run only Git scanner
hardpoint scan --scanners git

# Run both (default)
hardpoint scan
```
